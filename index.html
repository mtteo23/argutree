<html lang="en">
	<head>
		<link rel="stylesheet" href="style.css">
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Load Code File</title>
		<script defer src="script.js"></script>
	</head>

	<body>
		<div id="graph" align="center">
		</div>
	</body>
	
	<!-- Embed the code.txt content directly in the HTML -->
    <script id="code-data" type="text/plain">
0{QASC vadano introdotte le uniformi scolastiche}{Reasoning 0}
1-0{Migliorano l' ambiente scolastico}{Reasoning 1}
2-0{Appianano le differenze sociali}{Reasoning 2}
3-0{Assertion 3}{Reasoning 3}
1-1-0{Creano un senso di comunita}{Reasoning 4}
    </script>

	<script>
		selId='';
        document.addEventListener('DOMContentLoaded', () => {
			refocus('0');
        });
        
        function refocus(id){
			document.getElementById("graph").innerHTML = ""; 
			selId=id;
			parId=selId.slice(selId.search('-')+1);
			
			{
				const element = document.createElement('div');
				element.id = selId; // Assign a unique id
				element.classList.add("Argument");
				document.getElementById('graph').appendChild(element); // Append to the container
			}
			
			const MainDiv = document.getElementById(selId);
			
			
			{
				const element = document.createElement('ul');
				element.id = 'EvList-'+selId; // Assign a unique id
				element.classList.add("EvidenceList");
				MainDiv.appendChild(element); // Append to the container
			}
			{
				const element = document.createElement('ul');
				element.id = '-'+selId; // Assign a unique id
				element.classList.add("SubArgList");
				MainDiv.appendChild(element); // Append to the container
			}
			
			
			const SubArgList = document.getElementById('-'+selId);
			const EvidenceList = document.getElementById('EvList-'+selId);
			
            // Get the embedded text content from the script tag
            const codeData = document.getElementById('code-data').textContent;

            // Split the content into lines
            const rows = codeData.split('\n');

            rows.forEach((row, index) => {
				text=row.trim()
				if(text!='')
				{
					
					startAss=text.search("{")+1;
					startRes=text.search("}{")+2;
					
					if(text.slice(0,startAss-1)==parId && selId!=0)
					{
						const element = document.createElement('p');
						id='A-'+selId.slice(selId.search('-')+1);
						element.id = id; // Assign a unique id
						element.classList.add("ParentArgument");
						element.textContent = text.slice(startAss, startRes-2);
						element.onclick=function() { refocus(element.id.slice(2)); };
						document.getElementById('graph').insertBefore(element, document.getElementById('graph').firstChild);
						
					}
					
					if(text.slice(0,startAss-1)==selId)
					{
						const element = document.createElement('p');
						id='A-'+text.slice(0, startAss-1);
						element.id = id; // Assign a unique id
						element.classList.add("Reasoning");
						element.textContent = text.slice(startRes, text.length-1);
						MainDiv.insertBefore(element, MainDiv.firstChild);
					
						const element2 = document.createElement('p');
						id='A-'+text.slice(0, startAss-1);
						element2.id = id; // Assign a unique id
						element2.classList.add("Assertion");
						element2.textContent = text.slice(startAss, startRes-2);
						MainDiv.insertBefore(element2, MainDiv.firstChild);
					}
					
					if(text.slice(text.search('-'),startAss-1)=='-'+selId)
					{
						const element = document.createElement('li');
						id='A-'+text.slice(0, startAss-1);
						element.id = id;
						element.textContent = text.slice(startAss, startRes-2);
						element.onclick=function() { refocus(element.id.slice(2)); };
						SubArgList.appendChild(element); // Append to the container
					}
				}
            });
		}
    </script>
</html>
